use os;
include "testutil";

program test_env()
  return 1;
endprogram

exported function get_env()
  var res:=GetEnvironmentVariable("POLCORE_TEST");
  if (res != "1")
    return ret_error("Environment variable not found got: "+res);
  endif
  return 1;
endfunction

exported function list_env()
  var res:=GetEnvironmentVariable();
  if (res["POLCORE_TEST"] != "1")
    return ret_error("Environment variable not found got: "+res);
  endif
  return 1;
endfunction

exported function get_bad_env()
  // Alternating caps for case-sensitivity checking.
  var res:=GetEnvironmentVariable("PaTh");
  if (res.errortext != "Environment Variable access disallowed due to pol.cfg setting")
    return ret_error("Environment variable found when expected error, got: "+res);
  endif
  return 1;
endfunction
